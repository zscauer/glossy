# Описание

Приложение представляет собой сервис, позволяющий хранить информацию в виде небольших информационных карточек,
состоящих из наименования и описания. Карточки могут быть объеденены общими тегами.

## Использование

Одно из основных предназначений сервиса - отделение информационных сообщений приложения от кода этого приложения и их переиспользование.
Например, пользователям доступны сервисы Service1, Service2, ServiceN.
Каждый из этих сервисов может выдать пользователю сообщение о недостаточности прав доступа.
Этому сообщению присваивается собственный идентификатор, например ABC01, и все сервисы выдают пользователю этот идентификатор с ссылкой на расположение Glossy,
куда пользователь может обратиться за подробной информацией по этой ошибке.
Если описание ошибки потребует изменений, достаточно изменить это описание в Glossy, и пользователям всех сервисов сразу станет доступна актуальная информация.


Для создания/редактирования информации, необходимо авторизоваться под профилем, позволяющим вносить изменения.
При отсутствии авторизации доступен только просмотр.

## Ролевая модель

Авторизация осуществляется путем выбора профиля и вводом его ключа на странице изменения режима доступа в интерфейсе сервиса.

### Доступные профили

- `OBSERVER` - не требует авторизации, доступен только просмотр информации
- `MODERATOR` - авторизация по ключу, доступно создание/редактирование информации
- `ADMIN` - авторизация по ключу, доступно создание/редактирование/удаление информации, просмотр истории изменений

# Конфигурация

Сервис предоставляет значения по умолчанию для всех необходимых параметров, что позволяет обеспечить полную работоспособность без предварительной кофигурации.

*По умолчанию, если источник данных (база данных) не указаны, приложение создаст файл с базой данных в текущей директории
и подключится к ней*.
Созданную базу данных можно резервировать любым удобным способом.

## Параметры

Источником конфигурации является файл [application.yaml](../../src/main/resources/application.yaml).

Что бы переопределить значения параметров по умолчанию, можно задать требуемые значения непосредственно через переменные окружения среды,
либо описать их в `.env` файле, расположенном в директории, из которой осуществляется запуск приложения.

**GLOSSY_HTTP_PORT** - HTTP порт, по которому сервис будет доступен

**GLOSSY_DATASOURCE_DRIVER** - Тип используемой базы данных (на текущий момент поддерживаются значения `h2` и `postgresql`)  
**GLOSSY_DATASOURCE_LOCATION** - Путь к базе данных  
**GLOSSY_DATASOURCE_CONNECTION_PARAMETERS** - Дополнительные параметры подключения к базе данные (ssl и т.д.)  
**GLOSSY_DATASOURCE_LOGIN** - Имя пользователя базы данных  
**GLOSSY_DATASOURCE_PWD** - Пароль пользователя базы данных

**GLOSSY_SECURITY_PROFILE_MODERATOR_SECRET** - Пароль для профиля 'MODERATOR'  
**GLOSSY_SECURITY_PROFILE_ADMIN_SECRET** - Пароль для профиля 'ADMIN'

**GLOSSY_HISTORY_INFORMATION_NOTES_ENABLED** - Должна ли сохранятся история изменений информационных карточек

# Сборка

Приложение написано на Java и требует версию 21 или выше.

## JVM

```shell
./mvnw clean package
```

Собранный артефакт располагается в каталоге `target` с имененем `glossy-app.jar`.  
Такая версия приложения требует 64Mb оперативной памяти для корректной работы.

## Native

Сервис поддерживает сборку в нативный образ как с использованием установленного [GraalVM](https://www.graalvm.org/), так и без него (потребуется установленный Docker).    
Собранный артефакт располагается в каталоге `target` с имененем `glossy-app`.  
Такая версия приложения требует 32Mb оперативной памяти для корректной работы.

### С использованием GraalVM

```shell
./mvnw clean package -Dnative
```

### С использованием Docker (Container build)

**Результатом сборки будет исполняемый файл для Linux**.

```shell
export GLOSSY_NATIVE_CONTAINER_BIULD=true && ./mvnw clean package -Dnative
```

# Контейнеризация